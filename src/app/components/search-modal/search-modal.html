<div class="search-backdrop" (click)="onBackdropClick($event)" (keydown)="onKeydown($event)">
  <div class="search-dialog" role="dialog" aria-modal="true" aria-label="Search posts">
    <div class="search-input-wrap">
      <i class="ph ph-magnifying-glass search-icon"></i>
      <input
        #searchInput
        type="text"
        placeholder="Search postsâ€¦"
        [value]="query()"
        (input)="onInput($event)"
        (keydown)="onKeydown($event)"
        aria-label="Search"
      />
      <kbd>ESC</kbd>
      <button class="search-close-btn" type="button" (click)="close()" aria-label="Close search">
        <i class="ph ph-x" aria-hidden="true"></i>
      </button>
    </div>

    <div class="search-results">
      @if (query() && results().length === 0) {
        <div class="search-empty">No results for "{{ query() }}"</div>
      } @else if (!query()) {
        <div class="search-empty">Type to search posts</div>
      } @else {
        @for (result of results(); track result.slug; let i = $index) {
          <button
            class="search-result-item"
            [class.active]="i === activeIndex()"
            (click)="goTo(result)"
            (mouseenter)="activeIndex.set(i)"
          >
            <div class="result-title">{{ result.title }}</div>
            <div class="result-meta">
              <span class="result-date">{{ result.date }}</span>
              <span class="result-match-tag">{{ matchLabel(result.matchField) }}</span>
            </div>
            <div class="result-snippet">{{ result.snippet }}</div>
          </button>
        }
      }
    </div>
  </div>
</div>
